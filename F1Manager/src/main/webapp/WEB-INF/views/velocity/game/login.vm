<html>
	<head>
		<title></title>
	</head>
<body>

#parse("./game/includes/menu.vm")

	<div class="container">

		<form action="login" method="post">
		  <div class="form-group">
			<label>Felhasználónév</label>
				<input type="text" class="form-control" name="name" value="$!user.name" placeholder="Add meg a felhasználóneved!">
		  </div>
		  <div class="form-group">
			<label>Jelszó</label>
				<input type="password" class="form-control"  name="password" placeholder="Add meg a jelszavad!">
		  </div>
		  <button type="submit" class="btn btn-primary">Submit</button>
		</form>
			
			#if($notSuccessLogin)
				<div class="alert alert-danger" role="alert">Sikertelen bejelentkezés!</div>
			#end	
	</div>
	
	<div id="forgetPwOpenerDiv">
		<button class="btn btn-primary" onclick="showForgetPasswordDiv()">Elfelejtettem a jelszavam!</button>
	</div>
	
	<div id="forgetPasswordDiv" style="display:none;">
		Elfelejtett jelszó: <input type="text" id="email"></input>
		<button class="btn btn-primary" onclick="forgottenPassword()">Új jelszó igénylése</button>
	</div>
	
	<p id="emailProcessing" style="display:none;">
		email kuldes folyamatban par mp
	</p>
	<p id="emailSentOut" style="display:none;">
		email kikuldve
	</p>
	<p id="emailFail" style="display:none;">
		email kuldes sikertelen
	</p>
	
</body>
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script>
	function showForgetPasswordDiv(){
	console.log(1);
		$( "#forgetPasswordDiv" ).show();
		$( "#forgetPwOpenerDiv" ).hide();
	}
	
	function forgottenPassword(){
	
		$( "#emailProcessing" ).show();
		
		var json = {"email": $( "#email" ).val()};

		$.ajax({
		type: "POST",
		dataType: "json",
		data: JSON.stringify(json),
		url : "sendNewPasswordToken",
		contentType: 'application/json',
	    mimeType: 'application/json',
	    
		success : function(data) {
			if(data) {
				$( "#emailProcessing" ).hide();
				$( "#emailSentOut" ).show();
			}
			else{
				$( "#emailProcessing" ).hide();
				$( "#emailFail" ).show();
			}
		},
		error: function(data){
				$( "#emailProcessing" ).hide();
				$( "#emailFail" ).show();
		}
	});
	}
</script>
</html>